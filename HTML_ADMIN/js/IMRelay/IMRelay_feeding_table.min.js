$(function(){function h(n){var t=document.createElement("button");return t.className="btn btn-default",t.type="button",t.id="toogle_edit_button"+n,t.innerText=n+": Edit",'<td style="width:65px;">'+t.outerHTML+"<\/td>"}function c(n,t,i){var u=n.attributeWriter(t),r="<td";return n.textAlign="center",(n.hidden||n.textAlign)&&(r+=' style="',n.hidden&&(r+="display: none;"),n.textAlign&&(r+="text-align: "+n.textAlign+";"),r+='"'),i&&(r+=' class="user_editable"'),r+">"+u+"<\/td>"}function l(n){return editable_columns=["nr_of_fish","avg_fish_kg","feeder_speed_kg_pr_min","feeding_percent"],$.inArray(n,editable_columns)!=-1?!0:!1}function a(n,t,i,r){var f="",e=new Date(t.start_date),s=e.getFullYear().toString()+"-"+("0"+(e.getMonth()+1).toString()).slice(-2)+"-"+("0"+e.getDate().toString()).slice(-2),u,o;for(t.start_date=s,t.biomass=t.nr_of_fish*t.avg_fish_kg,t.required_feed_pr_day=t.biomass*t.feeding_percent,t.time_feeder_active=t.required_feed_pr_day/t.feeder_speed_kg_pr_min,t.feeder_toggle_speed=t.time_feeder_active/t.time_feeding_intervals,f+=h(t.id),u=1,o=i.length;u<o;u++)f+=r(i[u],t,l(i[u].id));return"<tr>"+f+"<\/tr>"}function v(t){$("#toogle_edit_button"+t).click(function(){var r=$("table#feeding_table tr:nth-child("+t+") td.user_editable"),i=!r.is(".editable");if(this.innerHTML=i?t+": Save":t+": Edit",r.prop("contenteditable",i).toggleClass("editable"),!i){var f=$("table#feeding_table tr:nth-child("+t+") td:nth-child(4)").html(),u=$("table#feeding_table tr:nth-child("+t+") td:nth-child(5)").html(),o=$("table#feeding_table tr:nth-child("+t+") td:nth-child(7)").html(),e=$("table#feeding_table tr:nth-child("+t+") td:nth-child(8)").html();n.update([{id:t,nr_of_fish:f,avg_fish_kg:u,feeder_speed_kg_pr_min:u,feeding_percent:e},])}})}function s(n){n||console.log("daily event has fired");var i=new Date,t=new Date;t.setSeconds(t.getSeconds()+10);window.setTimeout(s,t-i)}var n=new vis.DataSet,e=localStorage["feeder.table"],o,t,u,f,i,r;if(e!=null)o=JSON.parse(e),n.update(o);else for(t=1;t<=16;t++)n.add({id:t,state:"inactive",start_date:(new Date).setHours(0,0,0,0),nr_of_fish:"0",avg_fish_kg:"1",biomass:"1",feeder_speed_kg_pr_min:"1",feeding_percent:"1",required_feed_pr_day:"1",feed_progress_today:"1",time_feeding_intervals:"1",time_feeder_active:"1",feeder_toggle_speed:"1"});u=new vis.DataView(n,{fields:["id","state","start_date","nr_of_fish","avg_fish_kg","feeder_speed_kg_pr_min","feeding_percent"]});u.on("*",function(){console.log("saved");var n=u.get();localStorage["feeder.table"]=JSON.stringify(n)});f=n.get();n.on("*",function(){f=n.get()});for(n.update([{id:1,state:"active"},{id:2,state:"active"}]),$("#feeding_table").dynatable({features:{paginate:!1,sorting:!1,recordCount:!1,search:!1},dataset:{records:f},writers:{_rowWriter:a,_cellWriter:c}}),i=$("#feeding_table").data("dynatable"),i.sorts.clear(),i.sorts.add("id",1),i.process(),r=1;r<=16;r++)v(r);s(!0)});
/*
//# sourceMappingURL=IMRelay_feeding_table.min.js.map
*/