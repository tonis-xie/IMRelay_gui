function generate_csv_from_table(){var n="data:text/csv; charset=utf-8,";n+=$("#log_table").table2CSV({delivery:"value"});$("a#download_log_button").attr("href",encodeURI(n));$("a#download_log_button").attr("download","IMRelay_log.csv")}function write_log_table(n){var r,f;$("#log_table > tbody").html("");$("#log_table > tfoot").html("");var e,o,i=g_LDA.log_table.get({filter:function(t){return t.relay_number==n}}),s=$("#log_table").find("tr:first th").length,u=[],t=[];for(r=0;r<s;r++)u[r]=$("#log_table").find("th").eq(r).attr("data-dynatable-column"),t[u[r]]="";t.relay_name="SUM";t.nr_of_dead_fish=0;t.required_feed_pr_day=0;t.feed_progress_today=0;t.time_feeder_active=0;t.time_feeding_intervals=0;f=0;for(row in i)e+=log_table_row_writer(i[row],u),t.nr_of_dead_fish+=+i[row].nr_of_dead_fish,t.required_feed_pr_day+=+i[row].required_feed_pr_day,t.feed_progress_today+=+i[row].feed_progress_today,t.time_feeder_active+=+i[row].time_feeder_active,t.time_feeding_intervals+=+i[row].time_feeding_intervals,f++;t.date=f+" days";o+=log_table_row_writer(t,u);$("#log_table > tbody").append(e);$("#log_table > tfoot").append(o);generate_csv_from_table()}function log_table_cell_writer(n){return"<td>"+n+"<\/td>"}function log_table_row_writer(n,t){for(var i,u="",r=0;r<t.length;r++)i=n[t[r]],t[r]=="required_feed_pr_day"||t[r]=="feed_progress_today"?(i=parseInt(i).toFixed(3),u+=log_table_cell_writer(i)):t[r]=="time_feeder_active"||t[r]=="time_feeding_intervals"?(i=parseInt(i).toFixed(1),u+=log_table_cell_writer(i)):u+=log_table_cell_writer(i);return"<tr>"+u+"<\/tr>"}$(window).load(function(){"use strict";var n,t;g_LDA.log_table=new vis.DataSet;n=localStorage["feeder.log"];n!=null&&(t=JSON.parse(n),g_LDA.log_table.update(t));g_LDA.log_table.on("*",function(){var t=g_LDA.log_table.get(),n;localStorage["feeder.log"]=JSON.stringify(t);n=$("input[name=event_relay]:radio").val();write_log_table(n)})});
/*
//# sourceMappingURL=IMRelay_log.min.js.map
*/