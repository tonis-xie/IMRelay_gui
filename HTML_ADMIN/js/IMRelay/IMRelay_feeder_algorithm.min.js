function find_nearest_value_from_array(n){var t=null;return $.each([0,1/10,2/10,3/10,4/10,5/10,6/10,7/10,8/10,9/10],function(){(t===null||Math.abs(this-n)<Math.abs(t-n))&&(t=this)}),t*10}function which_relays_should_toogle(n){var i=[],r=g_LDA.groups.get({fields:["id","className"]});for(var t in g_LDA.items._data)n<g_LDA.items._data[t].end&&n>=g_LDA.items._data[t].start&&r[g_LDA.items._data[t].group-1].className==="vis_group_enabled"&&i.push(g_LDA.items._data[t].group);return i}function relay_event_scheduler(){for(var u=which_relays_should_toogle(new Date),t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=[],r=0,h=g_LDA.feeding_table.get({fields:["id","feeder_speed_kg_pr_min"]}),e,n,i,o,s,r=0;r<16;r++)t[r]=0;for(e in u)n=u[e],f[n-1]=g_LDA.relay[n-1].toggle_factor>.9?!0:!1,g_LDA.relay[n-1].on<=0&&g_LDA.relay[n-1].off<=0&&(g_LDA.relay[n-1].type==="generic"?(g_LDA.relay[n-1].on=g_LDA.relay[n-1].total_on_ticks,g_LDA.relay[n-1].off=g_LDA.relay[n-1].total_off_ticks):g_LDA.relay[n-1].on_ticks_remaining+g_LDA.relay[n-1].off_ticks_remaining>=10?(g_LDA.relay[n-1].accumulate+=g_LDA.relay[n-1].toggle_factor,i=find_nearest_value_from_array(g_LDA.relay[n-1].accumulate),g_LDA.relay[n-1].accumulate-=i/10,g_LDA.relay[n-1].on=i,g_LDA.relay[n-1].off=10-i,g_LDA.relay[n-1].on_ticks_remaining-=i,g_LDA.relay[n-1].off_ticks_remaining-=10-i):(g_LDA.relay[n-1].on=g_LDA.relay[n-1].on_ticks_remaining,g_LDA.relay[n-1].off=g_LDA.relay[n-1].off_ticks_remaining,g_LDA.relay[n-1].on_ticks_remaining=0,g_LDA.relay[n-1].off_ticks_remaining=0)),g_LDA.relay[n-1].on>0?(--g_LDA.relay[n-1].on,t[n-1]=1):g_LDA.relay[n-1].off>0&&(--g_LDA.relay[n-1].off,t[n-1]=0);o=localStorage.uuid_lock;s=JSON.stringify({uuid:o,relays:t});console.log(t),function(n){(g_LDA.ip_address.indexOf("192.168.")>-1||g_LDA.ip_address.indexOf("169.254.")>-1)&&$.ajax({url:"http://"+g_LDA.ip_address+"/relays.ajax",type:"POST",data:s,timeout:500,success:function(){var r,t,i,u;for($("#feeding_table th").each(function(n){$(this).attr("data-dynatable-column")==="feed_progress_today"&&(r=n)}),t=0;t<16;t++)i=n[t]===1,relay_indicator_control(t+1,i,f[t],!1),i&&g_LDA.relay[t].type==="feeder"&&(g_LDA.feed[t]+=h[t].feeder_speed_kg_pr_min/60,u=$("table#feeding_table tr:nth-child("+(t+1)+") td:nth-child("+(r+1)+")"),u.text(g_LDA.feed[t].toFixed(3)))},error:function(t,i,r){for(var u=0;u<16;u++)relay_indicator_control(u+1,n[u]===1,r[u],!0);r==="timeout"?console.log("error: timeout"):console.log(t.status,t.responseText,i,r)}})}(t)}
/*
//# sourceMappingURL=IMRelay_feeder_algorithm.min.js.map
*/