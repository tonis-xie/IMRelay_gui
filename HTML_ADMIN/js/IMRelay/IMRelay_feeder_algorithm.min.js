function find_nearest_value_from_array(n){var t=null;return $.each([0,1/10,2/10,3/10,4/10,5/10,6/10,7/10,8/10,9/10],function(){(t===null||Math.abs(this-n)<Math.abs(t-n))&&(t=this)}),t*10}function which_relays_should_toogle(n){var i=[],r=g_LDA.groups.get({fields:["id","className"]});for(var t in g_LDA.items._data)n<g_LDA.items._data[t].end&&n>=g_LDA.items._data[t].start&&r[g_LDA.items._data[t].group-1].className==="vis_group_enabled"&&i.push(g_LDA.items._data[t].group);return i}function relay_event_scheduler(){for(var u=which_relays_should_toogle(new Date),i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=[],t=0,h=g_LDA.feeding_table.get({fields:["id","feeder_speed_kg_pr_min"]}),e,n,r,o,s,t=0;t<16;t++)i[t]=0;for(e in u)n=u[e],f[n-1]=g_LDA.relay[n-1].toggle_factor>.9?!0:!1,g_LDA.relay[n-1].on<=0&&g_LDA.relay[n-1].off<=0&&(g_LDA.relay[n-1].type==="generic"?(g_LDA.relay[n-1].on=g_LDA.relay[n-1].total_on_ticks,g_LDA.relay[n-1].off=g_LDA.relay[n-1].total_off_ticks):g_LDA.relay[n-1].on_ticks_remaining+g_LDA.relay[n-1].off_ticks_remaining>=10?(g_LDA.relay[n-1].accumulate+=g_LDA.relay[n-1].toggle_factor,r=find_nearest_value_from_array(g_LDA.relay[n-1].accumulate),g_LDA.relay[n-1].accumulate-=r/10,g_LDA.relay[n-1].on=r,g_LDA.relay[n-1].off=10-r,g_LDA.relay[n-1].on_ticks_remaining-=r,g_LDA.relay[n-1].off_ticks_remaining-=10-r):(g_LDA.relay[n-1].on=g_LDA.relay[n-1].on_ticks_remaining,g_LDA.relay[n-1].off=g_LDA.relay[n-1].off_ticks_remaining,g_LDA.relay[n-1].on_ticks_remaining=0,g_LDA.relay[n-1].off_ticks_remaining=0)),g_LDA.relay[n-1].on>0?(--g_LDA.relay[n-1].on,i[n-1]=1,g_LDA.relay[n-1].type==="feeder"&&(g_LDA.feed[n-1]+=h[n-1].feeder_speed_kg_pr_min/60,$("#feeding_table th").each(function(t){if($(this).attr("data-dynatable-column")=="feed_progress_today"){var i=$("table#feeding_table tr:nth-child("+n+") td:nth-child("+(t+1)+")");i[0].innerText=g_LDA.feed[n-1].toFixed(3)}}))):g_LDA.relay[n-1].off>0&&(--g_LDA.relay[n-1].off,i[n-1]=0);o=localStorage.uuid_lock;s=JSON.stringify({uuid:o,relays:i});console.log(i),function(n){(g_LDA.ip_address.indexOf("192.168.1.")>-1||g_LDA.ip_address.indexOf("169.254.4.")>-1)&&$.ajax({url:"http://"+g_LDA.ip_address+"/relays.ajax",type:"POST",data:s,timeout:1e3,success:function(){for(t=0;t<16;t++)relay_indicator_control(t+1,n[t]===1,f[t],!1)},error:function(i,r,u){for(t=0;t<16;t++)relay_indicator_control(t+1,n[t]===1,u[t],!0);u==="timeout"?console.log("error: timeout"):console.log(i.status,i.responseText,r,u)}})}(i)}
/*
//# sourceMappingURL=IMRelay_feeder_algorithm.min.js.map
*/